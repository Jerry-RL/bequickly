# bequickly å­¦ä¹ æŒ‡å—

> æœ¬æ–‡æ¡£é¢å‘å‰ç«¯åˆå­¦è€…ï¼Œæ—¨åœ¨å¸®åŠ©ç†è§£ bequickly çš„è®¾è®¡æ€è·¯å’Œå®ç°åŸç†ã€‚

## ğŸ“š ç›®å½•

- [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
- [è®¾è®¡æ€è·¯](#è®¾è®¡æ€è·¯)
- [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
- [æ ¸å¿ƒåŠŸèƒ½å®ç°](#æ ¸å¿ƒåŠŸèƒ½å®ç°)
- [ä»£ç è§£æ](#ä»£ç è§£æ)
- [æ‰©å±•å­¦ä¹ ](#æ‰©å±•å­¦ä¹ )

## é¡¹ç›®æ¦‚è¿°

### ä»€ä¹ˆæ˜¯ CLI å·¥å…·ï¼Ÿ

CLIï¼ˆCommand Line Interfaceï¼Œå‘½ä»¤è¡Œç•Œé¢ï¼‰å·¥å…·æ˜¯ä¸€ç§é€šè¿‡å‘½ä»¤è¡Œç»ˆç«¯æ¥ä½¿ç”¨çš„ç¨‹åºã€‚å¸¸è§çš„ä¾‹å­åŒ…æ‹¬ï¼š
- `npm` - Node.js åŒ…ç®¡ç†å™¨
- `git` - ç‰ˆæœ¬æ§åˆ¶å·¥å…·
- `create-react-app` - React é¡¹ç›®è„šæ‰‹æ¶

### bequickly çš„ç›®æ ‡

bequickly çš„ç›®æ ‡æ˜¯ï¼š**è®©å¼€å‘è€…èƒ½å¤Ÿå¿«é€Ÿä»æ¨¡æ¿ç”Ÿæˆé¡¹ç›®ï¼Œé¿å…é‡å¤çš„åˆå§‹åŒ–å·¥ä½œ**ã€‚

ä¾‹å¦‚ï¼Œæ¯æ¬¡åˆ›å»ºæ–°çš„ Next.js é¡¹ç›®æ—¶ï¼Œéƒ½éœ€è¦ï¼š
1. åˆ›å»ºé¡¹ç›®ç›®å½•
2. å®‰è£…ä¾èµ–
3. é…ç½® TypeScriptã€Tailwind CSS ç­‰
4. è®¾ç½®é¡¹ç›®ç»“æ„

ä½¿ç”¨ bequicklyï¼Œåªéœ€è¦ä¸€ä¸ªå‘½ä»¤ï¼š`bequickly init vibe-sandbox my-project`

## è®¾è®¡æ€è·¯

### 1. æ ¸å¿ƒæ¦‚å¿µï¼šæ¨¡æ¿ç³»ç»Ÿ

**é—®é¢˜ï¼š** å¦‚ä½•è®©ç”¨æˆ·èƒ½å¤Ÿå¿«é€Ÿåˆ›å»ºé¡¹ç›®ï¼Ÿ

**è§£å†³æ–¹æ¡ˆï¼š** æ¨¡æ¿ç³»ç»Ÿ
- å°†å¸¸ç”¨çš„é¡¹ç›®ç»“æ„ä¿å­˜ä¸ºæ¨¡æ¿
- ç”¨æˆ·é€‰æ‹©æ¨¡æ¿ï¼Œå·¥å…·è‡ªåŠ¨å¤åˆ¶å¹¶é…ç½®

```
æ¨¡æ¿ç›®å½•ç»“æ„ï¼š
templates/
  â””â”€â”€ vibe-sandbox/          # ä¸€ä¸ªæ¨¡æ¿
      â”œâ”€â”€ package.json       # é¡¹ç›®é…ç½®
      â”œâ”€â”€ src/               # æºä»£ç 
      â””â”€â”€ ...                # å…¶ä»–æ–‡ä»¶
```

### 2. ç”¨æˆ·äº¤äº’è®¾è®¡

**é—®é¢˜ï¼š** å¦‚ä½•è®©å·¥å…·æ˜“ç”¨ï¼Ÿ

**è§£å†³æ–¹æ¡ˆï¼š** å¤šå±‚æ¬¡çš„äº¤äº’æ–¹å¼
- **å®Œå…¨äº¤äº’å¼**ï¼š`bequickly init` - é€æ­¥å¼•å¯¼ç”¨æˆ·
- **åŠäº¤äº’å¼**ï¼š`bequickly init vibe-sandbox` - æŒ‡å®šæ¨¡æ¿ï¼Œäº¤äº’è¾“å…¥é¡¹ç›®å
- **éäº¤äº’å¼**ï¼š`bequickly init vibe-sandbox my-project` - å®Œå…¨æŒ‡å®šå‚æ•°

### 3. å˜é‡æ›¿æ¢æœºåˆ¶

**é—®é¢˜ï¼š** æ¨¡æ¿ä¸­çš„é¡¹ç›®åã€ä½œè€…ç­‰ä¿¡æ¯å¦‚ä½•åŠ¨æ€æ›¿æ¢ï¼Ÿ

**è§£å†³æ–¹æ¡ˆï¼š** å˜é‡æ›¿æ¢ç³»ç»Ÿ
- æ¨¡æ¿ä¸­ä½¿ç”¨ `{{variableName}}` å ä½ç¬¦
- ç”Ÿæˆé¡¹ç›®æ—¶ï¼Œè‡ªåŠ¨æ›¿æ¢ä¸ºå®é™…å€¼

```json
// æ¨¡æ¿ä¸­çš„ package.json
{
  "name": "{{projectName}}",
  "description": "Project from {{templateName}}"
}

// ç”Ÿæˆåçš„ package.json
{
  "name": "my-project",
  "description": "Project from vibe-sandbox"
}
```

## æŠ€æœ¯æ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User Input    â”‚ ç”¨æˆ·è¾“å…¥å‘½ä»¤
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CLI Parser    â”‚ è§£æå‘½ä»¤å’Œå‚æ•° (Commander.js)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Commands      â”‚ æ‰§è¡Œå…·ä½“å‘½ä»¤ (init, add, delete...)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Utils         â”‚ å·¥å…·å‡½æ•° (æ¨¡æ¿ç®¡ç†ã€æ–‡ä»¶æ“ä½œ...)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   File System   â”‚ æ–‡ä»¶ç³»ç»Ÿæ“ä½œ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯é€‰å‹

| æŠ€æœ¯ | ä½œç”¨ | ä¸ºä»€ä¹ˆé€‰æ‹©å®ƒ |
|------|------|-------------|
| **TypeScript** | ç¼–ç¨‹è¯­è¨€ | ç±»å‹å®‰å…¨ï¼Œæ›´å¥½çš„å¼€å‘ä½“éªŒ |
| **Commander.js** | CLI æ¡†æ¶ | ç®€åŒ–å‘½ä»¤è¡Œå‚æ•°è§£æ |
| **Inquirer.js** | äº¤äº’å¼æç¤º | æä¾›å‹å¥½çš„ç”¨æˆ·äº¤äº’ |
| **fs-extra** | æ–‡ä»¶æ“ä½œ | æ¯”åŸç”Ÿ fs æ›´å¼ºå¤§ï¼Œæ”¯æŒ Promise |
| **Chalk** | ç»ˆç«¯é¢œè‰² | ç¾åŒ–è¾“å‡ºï¼Œæå‡ç”¨æˆ·ä½“éªŒ |

## æ ¸å¿ƒåŠŸèƒ½å®ç°

### 1. å‘½ä»¤è§£æï¼ˆCLI Entryï¼‰

**æ–‡ä»¶ï¼š** `src/cli.ts`

```typescript
import { Command } from 'commander';

const program = new Command();

program
  .name('bequickly')
  .description('A CLI tool for quickly generating projects from templates')
  .version(packageJson.version);

program
  .command('init')
  .description('Initialize a new project from a template')
  .argument('[template-name]', 'Name of the template to use')
  .argument('[project-name]', 'Name of the project to create')
  .action(async (templateName?: string, projectName?: string) => {
    await initCommand(templateName, projectName);
  });

program.parse();
```

**å…³é”®ç‚¹ï¼š**
- `[template-name]` ä¸­çš„ `[]` è¡¨ç¤ºå¯é€‰å‚æ•°
- `action` æ˜¯å‘½ä»¤æ‰§è¡Œçš„å›è°ƒå‡½æ•°
- ä½¿ç”¨ `async/await` å¤„ç†å¼‚æ­¥æ“ä½œ

### 2. æ¨¡æ¿å¤åˆ¶

**æ–‡ä»¶ï¼š** `src/utils/generator.ts`

```typescript
export async function copyTemplate(sourcePath: string, targetPath: string): Promise<void> {
  await fs.ensureDir(targetPath);
  
  await fs.copy(sourcePath, targetPath, {
    filter: (src: string) => {
      // æ’é™¤ä¸éœ€è¦çš„æ–‡ä»¶
      const excludePatterns = [
        'node_modules',
        '.git',
        'dist',
        // ...
      ];
      
      return !excludePatterns.some(pattern => 
        relativePath.includes(pattern) || basename === pattern
      );
    },
  });
}
```

**å…³é”®ç‚¹ï¼š**
- `fs.copy` é€’å½’å¤åˆ¶ç›®å½•
- `filter` å‡½æ•°å†³å®šå“ªäº›æ–‡ä»¶éœ€è¦å¤åˆ¶
- æ’é™¤ `node_modules`ã€`.git` ç­‰ä¸éœ€è¦çš„æ–‡ä»¶

### 3. å˜é‡æ›¿æ¢

**æ–‡ä»¶ï¼š** `src/utils/generator.ts`

```typescript
export async function replaceTemplateVariables(
  projectPath: string,
  variables: Record<string, any>
): Promise<void> {
  const files = await getAllFiles(projectPath);
  
  for (const file of files) {
    const content = await fs.readFile(file, 'utf-8');
    let newContent = content;
    
    // æ›¿æ¢ {{variableName}} æ ¼å¼çš„å˜é‡
    for (const [key, value] of Object.entries(variables)) {
      const regex = new RegExp(`\\{\\{${key}\\}\\}`, 'g');
      newContent = newContent.replace(regex, String(value));
    }
    
    if (newContent !== content) {
      await fs.writeFile(file, newContent, 'utf-8');
    }
  }
}
```

**å…³é”®ç‚¹ï¼š**
- éå†æ‰€æœ‰æ–‡ä»¶
- ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ `\{\{key\}\}` åŒ¹é…å˜é‡
- æ›¿æ¢ä¸ºå®é™…å€¼

### 4. äº¤äº’å¼æç¤º

**æ–‡ä»¶ï¼š** `src/commands/init.ts`

```typescript
import inquirer from 'inquirer';

const { selectedTemplate } = await inquirer.prompt([
  {
    type: 'list',
    name: 'selectedTemplate',
    message: 'Select a template:',
    choices: templates.map(t => ({
      name: t.name,
      value: t.name,
    })),
  },
]);
```

**å…³é”®ç‚¹ï¼š**
- `inquirer.prompt` æ˜¾ç¤ºäº¤äº’å¼æç¤º
- `type: 'list'` åˆ›å»ºä¸‹æ‹‰åˆ—è¡¨
- è¿”å›ç”¨æˆ·é€‰æ‹©çš„å€¼

### 5. ä¾èµ–å®‰è£…

**æ–‡ä»¶ï¼š** `src/utils/installer.ts`

```typescript
export async function installDependencies(projectPath: string): Promise<boolean> {
  // 1. æ£€æµ‹åŒ…ç®¡ç†å™¨ï¼ˆnpm/yarn/pnpmï¼‰
  const packageManager = await detectPackageManager(projectPath);
  
  // 2. æ£€æŸ¥åŒ…ç®¡ç†å™¨æ˜¯å¦å·²å®‰è£…
  if (!isPackageManagerInstalled(packageManager)) {
    return false;
  }
  
  // 3. æ‰§è¡Œå®‰è£…å‘½ä»¤
  execSync(`${packageManager} install`, {
    cwd: projectPath,
    stdio: 'inherit',
  });
}
```

**å…³é”®ç‚¹ï¼š**
- è‡ªåŠ¨æ£€æµ‹åŒ…ç®¡ç†å™¨ï¼ˆé€šè¿‡ lock æ–‡ä»¶æˆ– package.jsonï¼‰
- ä½¿ç”¨ `execSync` æ‰§è¡Œç³»ç»Ÿå‘½ä»¤
- `stdio: 'inherit'` è®©è¾“å‡ºæ˜¾ç¤ºåœ¨ç»ˆç«¯

## ä»£ç è§£æ

### å®Œæ•´çš„ init å‘½ä»¤æµç¨‹

```typescript
export async function initCommand(templateName?: string, projectName?: string) {
  // 1. è§£ææ¨¡æ¿åç§°å’Œç‰ˆæœ¬
  let parsedTemplateName = templateName;
  if (templateName && templateName.includes('@')) {
    const parts = templateName.split('@');
    parsedTemplateName = parts[0];
    parsedVersion = parts[1];
  }

  // 2. å¦‚æœæ²¡æœ‰æä¾›æ¨¡æ¿åï¼Œè®©ç”¨æˆ·é€‰æ‹©
  if (!parsedTemplateName) {
    const { selectedTemplate } = await inquirer.prompt([...]);
    parsedTemplateName = selectedTemplate;
  }

  // 3. æ£€æŸ¥æ¨¡æ¿æ˜¯å¦å­˜åœ¨
  const templatePath = path.join(templatesDir, parsedTemplateName);
  if (!(await fs.pathExists(templatePath))) {
    throw new Error('Template not found');
  }

  // 4. äº¤äº’å¼æ”¶é›†é¡¹ç›®ä¿¡æ¯
  const { projectDescription, author } = await inquirer.prompt([...]);

  // 5. å¤åˆ¶æ¨¡æ¿
  await copyTemplate(templatePath, projectPath);

  // 6. æ›¿æ¢å˜é‡
  await replaceTemplateVariables(projectPath, {
    projectName,
    projectDescription,
    author,
  });

  // 7. å®‰è£…ä¾èµ–
  await installDependencies(projectPath);
}
```

### å…³é”®è®¾è®¡æ¨¡å¼

#### 1. æ¨¡å—åŒ–è®¾è®¡

æ¯ä¸ªåŠŸèƒ½éƒ½æ‹†åˆ†æˆç‹¬ç«‹çš„æ¨¡å—ï¼š
- `commands/` - å‘½ä»¤å®ç°
- `utils/` - å·¥å…·å‡½æ•°
- èŒè´£æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤

#### 2. é”™è¯¯å¤„ç†

```typescript
try {
  await copyTemplate(templatePath, projectPath);
} catch (error: any) {
  console.error(chalk.red(`âŒ Error: ${error.message}`));
  process.exit(1);
}
```

#### 3. ç”¨æˆ·å‹å¥½æç¤º

```typescript
console.log(chalk.blue(`\nğŸ“¦ Creating project "${projectName}"...`));
console.log(chalk.green(`âœ“ Project created successfully!`));
```

ä½¿ç”¨ `chalk` æ·»åŠ é¢œè‰²å’Œ emojiï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚

## æ‰©å±•å­¦ä¹ 

### 1. å¦‚ä½•æ·»åŠ æ–°å‘½ä»¤ï¼Ÿ

1. åœ¨ `src/commands/` åˆ›å»ºæ–°æ–‡ä»¶ï¼Œä¾‹å¦‚ `update.ts`
2. å®ç°å‘½ä»¤å‡½æ•°ï¼š
   ```typescript
   export async function updateCommand(templateName: string) {
     // å®ç°æ›´æ–°é€»è¾‘
   }
   ```
3. åœ¨ `src/cli.ts` æ³¨å†Œå‘½ä»¤ï¼š
   ```typescript
   program
     .command('update')
     .description('Update a template')
     .action(async (templateName: string) => {
       await updateCommand(templateName);
     });
   ```

### 2. å¦‚ä½•æ‰©å±•å˜é‡æ›¿æ¢ï¼Ÿ

åœ¨ `replaceTemplateVariables` å‡½æ•°ä¸­æ·»åŠ æ–°çš„å˜é‡ï¼š
```typescript
await replaceTemplateVariables(projectPath, {
  projectName,
  projectDescription,
  author,
  date: new Date().toISOString(), // æ–°å¢å˜é‡
});
```

### 3. å¦‚ä½•æ”¯æŒæ›´å¤šåŒ…ç®¡ç†å™¨ï¼Ÿ

åœ¨ `detectPackageManager` å‡½æ•°ä¸­æ·»åŠ æ£€æµ‹é€»è¾‘ï¼š
```typescript
if (await fs.pathExists(path.join(projectPath, 'bun.lockb'))) {
  return 'bun';
}
```

### 4. æ¨èå­¦ä¹ èµ„æº

- **TypeScript å®˜æ–¹æ–‡æ¡£**ï¼šhttps://www.typescriptlang.org/docs/
- **Commander.js æ–‡æ¡£**ï¼šhttps://github.com/tj/commander.js
- **Node.js æ–‡ä»¶ç³»ç»Ÿ**ï¼šhttps://nodejs.org/api/fs.html
- **Inquirer.js æ–‡æ¡£**ï¼šhttps://github.com/SBoudrias/Inquirer.js

### 5. å®è·µå»ºè®®

1. **é˜…è¯»ä»£ç **ï¼šä» `src/cli.ts` å¼€å§‹ï¼Œç†è§£æ•´ä½“æµç¨‹
2. **ä¿®æ”¹æµ‹è¯•**ï¼šå°è¯•ä¿®æ”¹ä»£ç ï¼Œçœ‹çœ‹æ•ˆæœ
3. **æ·»åŠ åŠŸèƒ½**ï¼šå°è¯•æ·»åŠ ä¸€ä¸ªå°åŠŸèƒ½ï¼Œå¦‚è‡ªå®šä¹‰å˜é‡
4. **é˜…è¯»æºç **ï¼šç ”ç©¶å…¶ä»– CLI å·¥å…·çš„å®ç°ï¼Œå¦‚ `create-react-app`

## æ€»ç»“

bequickly çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š
1. **æ¨¡æ¿åŒ–**ï¼šå°†é¡¹ç›®ç»“æ„ä¿å­˜ä¸ºæ¨¡æ¿
2. **è‡ªåŠ¨åŒ–**ï¼šè‡ªåŠ¨å¤åˆ¶ã€æ›¿æ¢ã€å®‰è£…
3. **ç”¨æˆ·å‹å¥½**ï¼šæä¾›äº¤äº’å¼ç•Œé¢å’Œæ¸…æ™°çš„æç¤º

é€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œä½ å¯ä»¥å­¦ä¹ åˆ°ï¼š
- CLI å·¥å…·çš„å¼€å‘æµç¨‹
- TypeScript çš„å®é™…åº”ç”¨
- Node.js æ–‡ä»¶ç³»ç»Ÿæ“ä½œ
- ç”¨æˆ·äº¤äº’è®¾è®¡
- æ¨¡å—åŒ–ç¼–ç¨‹æ€æƒ³

å¸Œæœ›è¿™ä¸ªå­¦ä¹ æŒ‡å—èƒ½å¸®åŠ©ä½ ç†è§£ bequickly çš„è®¾è®¡å’Œå®ç°ï¼ğŸš€

